{% assign sidebar = site.data.sidebars[page.sidebar].entries %}

<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle">{{sidebar[0].product}}
      {% if sidebar[0].version %}
          {% comment %}
              This conditional is to decorate the sidebar header with " (Latest"), that is, IF the configured sidebar for the current page
              happens to be for the DataWave 'product', AND IF the sidebar 'version' matches our site.latest_minor_release (from _config.yml)
          {% endcomment %}

          {% if sidebar[0].version == site.latest_minor_release and sidebar[0].product == 'DataWave' %}
              {{sidebar[0].version}} (Latest)
          {% else %}
              {{sidebar[0].version}}
          {% endif %}
      {% endif %}
  </li>
{% for entry in sidebar %}
   {% for folder in entry.folders %}
   <li>
      <a href="#">{{ folder.title }}</a>
      <ul>
         {% for folderitem in folder.folderitems %}

             {% if folderitem.external_url %}
                <li><a href="{{folderitem.external_url}}" target="_blank">{{folderitem.title}}</a></li>
             {% elsif page.url == folderitem.url %}
                <li class="active"><a href="{{ site.baseurl }}{{ folderitem.url }}">{{folderitem.title}}</a></li>
             {% elsif folderitem.type == "empty" %}
                <li><a href="{{ site.baseurl }}{{ folderitem.url }}">{{folderitem.title}}</a></li>
             {% else %}
                <li><a href="{{ site.baseurl }}{{ folderitem.url }}">{{folderitem.title}}</a></li>
             {% endif %}

             {% for subfolders in folderitem.subfolders %}
                <li class="subfolders">
                <a href="#">{{ subfolders.title }}</a>
                <ul>
                   {% for subfolderitem in subfolders.subfolderitems %}
                      {% if subfolderitem.external_url %}
                         <li><a href="{{ subfolderitem.external_url }}" target="_blank">{{subfolderitem.title}}</a></li>
                      {% elsif page.url == subfolderitem.url %}
                         <li class="active"><a href="{{ site.baseurl }}{{ subfolderitem.url }}">{{subfolderitem.title}}</a></li>
                      {% else %}
                         <li><a href="{{ site.baseurl }}{{ subfolderitem.url }}">{{subfolderitem.title}}</a></li>
                      {% endif %}
                   {% endfor %}
                </ul>
                </li>
             {% endfor %}
         {% endfor %}
      </ul>
   </li>
   {% endfor %}
{% endfor %}
   <!-- if you aren't using the accordion, uncomment this block:
   <p class="external">
        <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
   </p>
   -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when
you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js,
the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
